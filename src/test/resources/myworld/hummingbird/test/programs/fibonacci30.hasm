.symbols
    fibonacci function $fibonacci
            int
            parameters 1
            registers 6

.code
  # fib(15)
  CONST ri0, 30
  CALL ri0, 0, 0, 0, 0, 0, 0, 0
  RETURN ri0
  fibonacci:
    PARAM ri0, 0
    CONST ri1, 2
    IFGE ri0, ri1, $recurse
    RETURN ri0
  recurse:
    # Constants (ri0 = n)
    CONST ri1, 1
    CONST ri2, 2
    #fib(n - 1)
    SUB ri0, ri1 #(ri0 = n - 1)
    CALL ri3, 0, 0, 0, 0, 0, 0, 0 #ri3 = fib(n - 1)
    #fib(n - 2)
    PARAM ri0, 0 #(ri0 = n)
    SUB ri0, ri2 #(ri0 = n - 2)
    CALL ri4, 0, 0, 0, 0, 0, 0, 0 #ri4 = fib(n - 2)
    ADD ri3, ri4
    RETURN ri3